<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Internship Rotation Schedule</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'pulse-fast': 'pulse 0.8s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-in': 'slideIn 0.5s ease-in-out',
                        'scale-in': 'scaleIn 0.3s ease-in-out',
                        'rotate-in': 'rotateIn 0.5s ease-in-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideIn: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                        scaleIn: {
                            '0%': { transform: 'scale(0.8)', opacity: '0' },
                            '100%': { transform: 'scale(1)', opacity: '1' },
                        },
                        rotateIn: {
                            '0%': { transform: 'rotate(-5deg) scale(0.9)', opacity: '0' },
                            '100%': { transform: 'rotate(0) scale(1)', opacity: '1' },
                        },
                    }
                }
            }
        }
    </script>
    <style>
        .week-cell {
            width: 40px;
            height: 40px;
            text-align: center;
            border: 1px solid #ddd;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }
        .header-cell {
            background-color: #f0f0f0;
            font-weight: bold;
        }
        .batch-cell {
            background-color: #e0e0e0;
            font-weight: bold;
        }
        .medicine { background-color: #ffcccc; }
        .surgery { background-color: #ccffcc; }
        .obgy { background-color: #ccccff; }
        .community { background-color: #ffffcc; }
        .misc { background-color: #ffccff; }
        
        .highlight {
            animation: pulse 1s infinite;
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.5);
            z-index: 10;
        }
        
        @keyframes pulse {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
            100% { opacity: 1; transform: scale(1); }
        }
        
        .legend-item {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 5px;
            vertical-align: middle;
        }

        .tooltip {
            position: absolute;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            z-index: 100;
            pointer-events: none;
            display: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            max-width: 250px;
        }

        .team-split-animation {
            position: relative;
            overflow: hidden;
        }

        .team-split-animation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.3);
            z-index: 1;
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.5s ease-out;
        }

        .team-split-animation.active::before {
            transform: scaleX(1);
        }

        .team-merge-animation {
            position: relative;
            overflow: hidden;
        }

        .team-merge-animation::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.3);
            z-index: 1;
            transform: scaleX(0);
            transform-origin: right;
            transition: transform 0.5s ease-out;
        }

        .team-merge-animation.active::after {
            transform: scaleX(1);
        }

        .phase-transition {
            transition: background-color 0.5s ease;
        }

        .schedule-container {
            overflow-x: auto;
            max-width: 100%;
            position: relative;
        }

        .phase-marker {
            position: absolute;
            top: 0;
            height: 100%;
            border-left: 2px dashed rgba(0, 0, 0, 0.2);
            z-index: 5;
            pointer-events: none;
        }

        .phase-label {
            position: absolute;
            top: -20px;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        /* Animation for team splitting */
        @keyframes splitTeam {
            0% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(-10px); opacity: 0.5; }
            100% { transform: translateY(0); opacity: 1; }
        }

        /* Animation for team merging */
        @keyframes mergeTeam {
            0% { transform: translateY(0); opacity: 1; }
            50% { transform: translateY(10px); opacity: 0.5; }
            100% { transform: translateY(0); opacity: 1; }
        }

        .split-animation {
            animation: splitTeam 1s ease-in-out;
        }

        .merge-animation {
            animation: mergeTeam 1s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 md:p-8">
    <div class="max-w-7xl mx-auto bg-white rounded-lg shadow-lg p-6 animate-fade-in">
        <h1 class="text-3xl font-bold text-center mb-6 animate-slide-in">Medical Internship Rotation Schedule</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 animate-slide-in" style="animation-delay: 0.1s">
            <div>
                <label for="batch-select" class="block text-lg font-medium mb-2">Select Batch:</label>
                <select id="batch-select" class="w-full p-2 border rounded-md transition-all hover:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                    <option value="A">Batch A (M → S → O → C)</option>
                    <option value="B">Batch B (S → O → C → M)</option>
                    <option value="C">Batch C (O → C → M → S)</option>
                    <option value="D">Batch D (C → M → S → O)</option>
                </select>
            </div>
            
            <div>
                <label for="week-select" class="block text-lg font-medium mb-2">Current Week:</label>
                <div class="flex items-center">
                    <button id="prev-week" class="px-4 py-2 bg-gray-200 rounded-l-md hover:bg-gray-300 transition-colors">&lt;</button>
                    <input type="number" id="week-select" min="1" max="52" value="1" class="w-full p-2 border text-center focus:ring-2 focus:ring-blue-500 focus:outline-none">
                    <button id="next-week" class="px-4 py-2 bg-gray-200 rounded-r-md hover:bg-gray-300 transition-colors">&gt;</button>
                </div>
            </div>

            <div>
                <label for="phase-select" class="block text-lg font-medium mb-2">Jump to Phase:</label>
                <select id="phase-select" class="w-full p-2 border rounded-md transition-all hover:border-blue-500 focus:ring-2 focus:ring-blue-500 focus:outline-none">
                    <option value="1">Medicine (Weeks 1-12)</option>
                    <option value="13">Surgery (Weeks 13-24)</option>
                    <option value="25">OBGY (Weeks 25-36)</option>
                    <option value="37">Community Medicine (Weeks 37-48)</option>
                    <option value="49">Miscellaneous (Weeks 49-52)</option>
                </select>
            </div>
        </div>
        
        <div class="flex justify-center gap-4 mb-6 animate-slide-in" style="animation-delay: 0.2s">
            <button id="simulate-btn" class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors transform hover:scale-105 active:scale-95">Start Simulation</button>
            <button id="stop-simulation" class="px-6 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors transform hover:scale-105 active:scale-95 hidden">Stop Simulation</button>
            <button id="reset-btn" class="px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors transform hover:scale-105 active:scale-95">Reset</button>
            <button id="animate-transitions-btn" class="px-6 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors transform hover:scale-105 active:scale-95">Show Transitions</button>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
            <div class="lg:col-span-1 p-4 bg-blue-50 rounded-lg shadow-sm animate-scale-in" style="animation-delay: 0.3s">
                <h2 class="text-xl font-bold mb-3">Current Status</h2>
                <div id="current-phase-info" class="text-lg mb-2">Phase: <span class="font-bold">Medicine (Week 1 of 12)</span></div>
                <div id="total-progress" class="text-lg">Overall Progress: <span class="font-bold">Week 1 of 52</span></div>
                <div class="w-full bg-gray-200 rounded-full h-2.5 mt-3">
                    <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-500" style="width: 2%"></div>
                </div>
            </div>
            
            <div class="lg:col-span-2 overflow-x-auto animate-scale-in" style="animation-delay: 0.4s">
                <h2 class="text-xl font-bold mb-3">Current Week Schedule</h2>
                <table id="current-week-table" class="w-full border-collapse">
                    <thead>
                        <tr>
                            <th class="border p-2 bg-gray-100">Subgroup</th>
                            <th class="border p-2 bg-gray-100">Current Posting</th>
                            <th class="border p-2 bg-gray-100">Department</th>
                            <th class="border p-2 bg-gray-100">Duration</th>
                            <th class="border p-2 bg-gray-100">Members</th>
                            <th class="border p-2 bg-gray-100">Status</th>
                        </tr>
                    </thead>
                    <tbody id="current-week-body">
                        <!-- Will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="mb-8 animate-scale-in" style="animation-delay: 0.5s">
            <h2 class="text-xl font-bold mb-3">Full Schedule Overview</h2>
            <div class="flex mb-2 flex-wrap">
                <button id="view-all" class="px-4 py-2 bg-blue-600 text-white rounded-l-md hover:bg-blue-700 transition-colors">View All Weeks</button>
                <button id="view-medicine" class="px-4 py-2 bg-red-200 text-gray-800 hover:bg-red-300 transition-colors">Medicine</button>
                <button id="view-surgery" class="px-4 py-2 bg-green-200 text-gray-800 hover:bg-green-300 transition-colors">Surgery</button>
                <button id="view-obgy" class="px-4 py-2 bg-blue-200 text-gray-800 hover:bg-blue-300 transition-colors">OBGY</button>
                <button id="view-community" class="px-4 py-2 bg-yellow-200 text-gray-800 hover:bg-yellow-300 transition-colors">Community</button>
                <button id="view-misc" class="px-4 py-2 bg-purple-200 text-gray-800 rounded-r-md hover:bg-purple-300 transition-colors">Misc</button>
            </div>
            <div class="schedule-container">
                <div class="flex mb-4 overflow-x-auto relative">
                    <div class="flex flex-col">
                        <div class="week-cell batch-cell">Week</div>
                        <div id="subgroups"></div>
                    </div>
                    <div id="schedule-grid" class="flex">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    <!-- Phase markers will be added here -->
                    <div id="phase-markers"></div>
                </div>
            </div>
            <div id="tooltip" class="tooltip"></div>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8 animate-rotate-in" style="animation-delay: 0.6s">
            <div class="border rounded-md p-4 shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-lg font-bold mb-2">Medicine (12 Weeks)</h3>
                <div class="legend-item medicine"></div> Medicine
                <table class="w-full mt-2">
                    <tr>
                        <th class="border p-1 text-sm">Code</th>
                        <th class="border p-1 text-sm">Subject</th>
                        <th class="border p-1 text-sm">Duration</th>
                        <th class="border p-1 text-sm">Members</th>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">GM</td>
                        <td class="border p-1 text-sm">General Medicine</td>
                        <td class="border p-1 text-sm">6 weeks</td>
                        <td class="border p-1 text-sm">17</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">PY</td>
                        <td class="border p-1 text-sm">Psychiatry</td>
                        <td class="border p-1 text-sm">2 weeks</td>
                        <td class="border p-1 text-sm">6</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">CA</td>
                        <td class="border p-1 text-sm">Casualty</td>
                        <td class="border p-1 text-sm">2 weeks</td>
                        <td class="border p-1 text-sm">6</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">EN</td>
                        <td class="border p-1 text-sm">ENT</td>
                        <td class="border p-1 text-sm">2 weeks</td>
                        <td class="border p-1 text-sm">5</td>
                    </tr>
                </table>
            </div>
            
            <div class="border rounded-md p-4 shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-lg font-bold mb-2">Surgery (12 Weeks)</h3>
                <div class="legend-item surgery"></div> Surgery
                <table class="w-full mt-2">
                    <tr>
                        <th class="border p-1 text-sm">Code</th>
                        <th class="border p-1 text-sm">Subject</th>
                        <th class="border p-1 text-sm">Duration</th>
                        <th class="border p-1 text-sm">Members</th>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">GS</td>
                        <td class="border p-1 text-sm">General Surgery</td>
                        <td class="border p-1 text-sm">6 weeks</td>
                        <td class="border p-1 text-sm">17</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">AN</td>
                        <td class="border p-1 text-sm">Anaesthesia</td>
                        <td class="border p-1 text-sm">2 weeks</td>
                        <td class="border p-1 text-sm">6</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">OR</td>
                        <td class="border p-1 text-sm">Orthopedics</td>
                        <td class="border p-1 text-sm">2 weeks</td>
                        <td class="border p-1 text-sm">6</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">OP</td>
                        <td class="border p-1 text-sm">Ophthalmology</td>
                        <td class="border p-1 text-sm">2 weeks</td>
                        <td class="border p-1 text-sm">5</td>
                    </tr>
                </table>
            </div>
            
            <div class="border rounded-md p-4 shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-lg font-bold mb-2">OBGY (12 Weeks)</h3>
                <div class="legend-item obgy"></div> OBGY
                <table class="w-full mt-2">
                    <tr>
                        <th class="border p-1 text-sm">Code</th>
                        <th class="border p-1 text-sm">Subject</th>
                        <th class="border p-1 text-sm">Duration</th>
                        <th class="border p-1 text-sm">Members</th>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">OB</td>
                        <td class="border p-1 text-sm">OBGY</td>
                        <td class="border p-1 text-sm">6 weeks</td>
                        <td class="border p-1 text-sm">17</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">PE</td>
                        <td class="border p-1 text-sm">Paediatrics</td>
                        <td class="border p-1 text-sm">3 weeks</td>
                        <td class="border p-1 text-sm">8</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">RM</td>
                        <td class="border p-1 text-sm">Respiratory Medicine</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">3</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">RA</td>
                        <td class="border p-1 text-sm">Radiology</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">3</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">DE</td>
                        <td class="border p-1 text-sm">Dermatology</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">3</td>
                    </tr>
                </table>
            </div>
            
            <div class="border rounded-md p-4 shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-lg font-bold mb-2">Community Medicine (12 Weeks)</h3>
                <div class="legend-item community"></div> Community Medicine
                <table class="w-full mt-2">
                    <tr>
                        <th class="border p-1 text-sm">Code</th>
                        <th class="border p-1 text-sm">Subject</th>
                        <th class="border p-1 text-sm">Duration</th>
                        <th class="border p-1 text-sm">Members</th>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">CH</td>
                        <td class="border p-1 text-sm">CHC</td>
                        <td class="border p-1 text-sm">3 weeks</td>
                        <td class="border p-1 text-sm">8</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">PH</td>
                        <td class="border p-1 text-sm">PHC</td>
                        <td class="border p-1 text-sm">3 weeks</td>
                        <td class="border p-1 text-sm">9</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">UH</td>
                        <td class="border p-1 text-sm">UHC</td>
                        <td class="border p-1 text-sm">3 weeks</td>
                        <td class="border p-1 text-sm">8</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">RH</td>
                        <td class="border p-1 text-sm">RHC</td>
                        <td class="border p-1 text-sm">3 weeks</td>
                        <td class="border p-1 text-sm">9</td>
                    </tr>
                </table>
            </div>
            
            <div class="border rounded-md p-4 shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-lg font-bold mb-2">Miscellaneous (4 Weeks)</h3>
                <div class="legend-item misc"></div> Miscellaneous
                <table class="w-full mt-2">
                    <tr>
                        <th class="border p-1 text-sm">Code</th>
                        <th class="border p-1 text-sm">Subject</th>
                        <th class="border p-1 text-sm">Duration</th>
                        <th class="border p-1 text-sm">Members</th>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">GY</td>
                        <td class="border p-1 text-sm">Gynecology (separate)</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">8</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">LM</td>
                        <td class="border p-1 text-sm">Lab Medicine</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">9</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">FM</td>
                        <td class="border p-1 text-sm">Forensic Medicine</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">8</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">YO</td>
                        <td class="border p-1 text-sm">Yoga</td>
                        <td class="border p-1 text-sm">1 week</td>
                        <td class="border p-1 text-sm">9</td>
                    </tr>
                </table>
            </div>

            <div class="border rounded-md p-4 shadow-sm hover:shadow-md transition-shadow">
                <h3 class="text-lg font-bold mb-2">Batch Information</h3>
                <table class="w-full mt-2">
                    <tr>
                        <th class="border p-1 text-sm">Batch</th>
                        <th class="border p-1 text-sm">Rotation Sequence</th>
                        <th class="border p-1 text-sm">Members</th>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">A</td>
                        <td class="border p-1 text-sm">M → S → O → C → MIS</td>
                        <td class="border p-1 text-sm">34</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">B</td>
                        <td class="border p-1 text-sm">S → O → C → M → MIS</td>
                        <td class="border p-1 text-sm">34</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">C</td>
                        <td class="border p-1 text-sm">O → C → M → S → MIS</td>
                        <td class="border p-1 text-sm">34</td>
                    </tr>
                    <tr>
                        <td class="border p-1 text-sm">D</td>
                        <td class="border p-1 text-sm">C → M → S → O → MIS</td>
                        <td class="border p-1 text-sm">34</td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Advanced data structure for the rotation system
        const RotationSystem = {
            // Total number of weeks in the internship
            totalWeeks: 52,
            
            // Total number of interns
            totalInterns: 136,
            
            // Number of batches
            batchCount: 4,
            
            // Number of subgroups per batch
            subgroupsPerBatch: 4,
            
            // Posting member counts - fixed as per requirements
            postingMemberCounts: {
                medicine: {
                    GM: 17,
                    PY: 6,
                    CA: 6,
                    EN: 5
                },
                surgery: {
                    GS: 17,
                    AN: 6,
                    OR: 6,
                    OP: 5
                },
                obgy: {
                    OB: 17,
                    PE: 8,
                    RM: 3,
                    RA: 3,
                    DE: 3
                },
                community: {
                    CH: 8,
                    PH: 9,
                    UH: 8,
                    RH: 9
                },
                misc: {
                    GY: 8,
                    LM: 9,
                    FM: 8,
                    YO: 9
                }
            },
            
            // Phase definitions with mathematical structure
            phases: {
                medicine: {
                    name: "Medicine",
                    code: "M",
                    duration: 12,
                    class: "medicine",
                    subphases: [
                        { code: "GM", name: "General Medicine", duration: 6 },
                        { code: "PY", name: "Psychiatry", duration: 2 },
                        { code: "CA", name: "Casualty", duration: 2 },
                        { code: "EN", name: "ENT", duration: 2 }
                    ],
                    // Function to calculate the posting for a given week and subgroup
                    getPosting: function(relativeWeek, subgroupIndex) {
                        // First subgroup (index 0) follows GM -> PY -> CA -> EN
                        if (subgroupIndex === 0) {
                            if (relativeWeek <= 6) return { code: "GM", name: "General Medicine", duration: 6, weeks: Array.from({length: 6}, (_, i) => i + 1) };
                            if (relativeWeek <= 8) return { code: "PY", name: "Psychiatry", duration: 2, weeks: [7, 8] };
                            if (relativeWeek <= 10) return { code: "CA", name: "Casualty", duration: 2, weeks: [9, 10] };
                            return { code: "EN", name: "ENT", duration: 2, weeks: [11, 12] };
                        }
                        
                        // Other subgroups follow different patterns
                        const patterns = [
                            ["PY", "CA", "EN", "GM"], // Subgroup 1 (index 1)
                            ["CA", "EN", "PY", "GM"], // Subgroup 2 (index 2)
                            ["EN", "PY", "CA", "GM"]  // Subgroup 3 (index 3)
                        ];
                        
                        const pattern = patterns[subgroupIndex - 1];
                        
                        if (relativeWeek <= 2) return { code: pattern[0], name: this.getSubphaseName(pattern[0]), duration: 2, weeks: [1, 2] };
                        if (relativeWeek <= 4) return { code: pattern[1], name: this.getSubphaseName(pattern[1]), duration: 2, weeks: [3, 4] };
                        if (relativeWeek <= 6) return { code: pattern[2], name: this.getSubphaseName(pattern[2]), duration: 2, weeks: [5, 6] };
                        return { code: pattern[3], name: this.getSubphaseName(pattern[3]), duration: 6, weeks: [7, 8, 9, 10, 11, 12] };
                    },
                    // Helper function to get subphase name from code
                    getSubphaseName: function(code) {
                        const subphase = this.subphases.find(sp => sp.code === code);
                        return subphase ? subphase.name : "";
                    },
                    // Function to determine if a team split or merge happens at this week
                    getTeamTransition: function(relativeWeek) {
                        if (relativeWeek === 6) return "split"; // At week 6, the first group splits
                        if (relativeWeek === 7) return "merge"; // At week 7, other groups merge into GM
                        return null;
                    }
                },
                surgery: {
                    name: "Surgery",
                    code: "S",
                    duration: 12,
                    class: "surgery",
                    subphases: [
                        { code: "GS", name: "General Surgery", duration: 6 },
                        { code: "AN", name: "Anaesthesia", duration: 2 },
                        { code: "OR", name: "Orthopedics", duration: 2 },
                        { code: "OP", name: "Ophthalmology", duration: 2 }
                    ],
                    getPosting: function(relativeWeek, subgroupIndex) {
                        // First subgroup follows GS -> AN -> OR -> OP
                        if (subgroupIndex === 0) {
                            if (relativeWeek <= 6) return { code: "GS", name: "General Surgery", duration: 6, weeks: Array.from({length: 6}, (_, i) => i + 1) };
                            if (relativeWeek <= 8) return { code: "AN", name: "Anaesthesia", duration: 2, weeks: [7, 8] };
                            if (relativeWeek <= 10) return { code: "OR", name: "Orthopedics", duration: 2, weeks: [9, 10] };
                            return { code: "OP", name: "Ophthalmology", duration: 2, weeks: [11, 12] };
                        }
                        
                        // Other subgroups follow different patterns
                        const patterns = [
                            ["AN", "OR", "OP", "GS"], // Subgroup 1
                            ["OR", "OP", "AN", "GS"], // Subgroup 2
                            ["OP", "AN", "OR", "GS"]  // Subgroup 3
                        ];
                        
                        const pattern = patterns[subgroupIndex - 1];
                        
                        if (relativeWeek <= 2) return { code: pattern[0], name: this.getSubphaseName(pattern[0]), duration: 2, weeks: [1, 2] };
                        if (relativeWeek <= 4) return { code: pattern[1], name: this.getSubphaseName(pattern[1]), duration: 2, weeks: [3, 4] };
                        if (relativeWeek <= 6) return { code: pattern[2], name: this.getSubphaseName(pattern[2]), duration: 2, weeks: [5, 6] };
                        return { code: pattern[3], name: this.getSubphaseName(pattern[3]), duration: 6, weeks: [7, 8, 9, 10, 11, 12] };
                    },
                    getSubphaseName: function(code) {
                        const subphase = this.subphases.find(sp => sp.code === code);
                        return subphase ? subphase.name : "";
                    },
                    getTeamTransition: function(relativeWeek) {
                        if (relativeWeek === 6) return "split";
                        if (relativeWeek === 7) return "merge";
                        return null;
                    }
                },
                obgy: {
                    name: "OBGY",
                    code: "O",
                    duration: 12,
                    class: "obgy",
                    subphases: [
                        { code: "OB", name: "OBGY", duration: 6 },
                        { code: "PE", name: "Paediatrics", duration: 3 },
                        { code: "RM", name: "Respiratory Medicine", duration: 1 },
                        { code: "RA", name: "Radiology", duration: 1 },
                        { code: "DE", name: "Dermatology", duration: 1 }
                    ],
                    getPosting: function(relativeWeek, subgroupIndex) {
                        // Mathematical approach for OBGY rotation
                        if (subgroupIndex === 0) {
                            if (relativeWeek <= 6) return { code: "OB", name: "OBGY", duration: 6, weeks: Array.from({length: 6}, (_, i) => i + 1) };
                            if (relativeWeek <= 9) return { code: "PE", name: "Paediatrics", duration: 3, weeks: [7, 8, 9] };
                            if (relativeWeek <= 10) return { code: "RM", name: "Respiratory Medicine", duration: 1, weeks: [10] };
                            if (relativeWeek <= 11) return { code: "RA", name: "Radiology", duration: 1, weeks: [11] };
                            return { code: "DE", name: "Dermatology", duration: 1, weeks: [12] };
                        }
                        
                        // Other subgroups follow different patterns
                        if (subgroupIndex === 1) {
                            if (relativeWeek <= 3) return { code: "PE", name: "Paediatrics", duration: 3, weeks: [1, 2, 3] };
                            if (relativeWeek <= 4) return { code: "RM", name: "Respiratory Medicine", duration: 1, weeks: [4] };
                            if (relativeWeek <= 5) return { code: "RA", name: "Radiology", duration: 1, weeks: [5] };
                            if (relativeWeek <= 6) return { code: "DE", name: "Dermatology", duration: 1, weeks: [6] };
                            return { code: "OB", name: "OBGY", duration: 6, weeks: [7, 8, 9, 10, 11, 12] };
                        }
                        
                        if (subgroupIndex === 2) {
                            if (relativeWeek <= 1) return { code: "RM", name: "Respiratory Medicine", duration: 1, weeks: [1] };
                            if (relativeWeek <= 2) return { code: "RA", name: "Radiology", duration: 1, weeks: [2] };
                            if (relativeWeek <= 3) return { code: "DE", name: "Dermatology", duration: 1, weeks: [3] };
                            if (relativeWeek <= 6) return { code: "PE", name: "Paediatrics", duration: 3, weeks: [4, 5, 6] };
                            return { code: "OB", name: "OBGY", duration: 6, weeks: [7, 8, 9, 10, 11, 12] };
                        }
                        
                        if (subgroupIndex === 3) {
                            if (relativeWeek <= 1) return { code: "DE", name: "Dermatology", duration: 1, weeks: [1] };
                            if (relativeWeek <= 2) return { code: "RM", name: "Respiratory Medicine", duration: 1, weeks: [2] };
                            if (relativeWeek <= 3) return { code: "RA", name: "Radiology", duration: 1, weeks: [3] };
                            if (relativeWeek <= 9) return { code: "OB", name: "OBGY", duration: 6, weeks: [4, 5, 6, 7, 8, 9] };
                            return { code: "PE", name: "Paediatrics", duration: 3, weeks: [10, 11, 12] };
                        }
                        
                        return { code: "", name: "", duration: 0, weeks: [] };
                    },
                    getTeamTransition: function(relativeWeek) {
                        if (relativeWeek === 6) return "split";
                        if (relativeWeek === 7) return "merge";
                        if (relativeWeek === 9) return "split";
                        return null;
                    }
                },
                community: {
                    name: "Community Medicine",
                    code: "C",
                    duration: 12,
                    class: "community",
                    subphases: [
                        { code: "CH", name: "CHC", duration: 3 },
                        { code: "PH", name: "PHC", duration: 3 },
                        { code: "UH", name: "UHC", duration: 3 },
                        { code: "RH", name: "RHC", duration: 3 }
                    ],
                    getPosting: function(relativeWeek, subgroupIndex) {
                        // Mathematical approach for Community Medicine rotation
                        // Each subgroup rotates through all 4 postings in a different order
                        const rotationPatterns = [
                            ["CH", "PH", "UH", "RH"], // Subgroup 0
                            ["PH", "UH", "RH", "CH"], // Subgroup 1
                            ["UH", "RH", "CH", "PH"], // Subgroup 2
                            ["RH", "CH", "PH", "UH"]  // Subgroup 3
                        ];
                        
                        const pattern = rotationPatterns[subgroupIndex];
                        const postingIndex = Math.floor((relativeWeek - 1) / 3);
                        const code = pattern[postingIndex];
                        const name = this.getSubphaseName(code);
                        const startWeek = (postingIndex * 3) + 1;
                        
                        return {
                            code: code,
                            name: name,
                            duration: 3,
                            weeks: [startWeek, startWeek + 1, startWeek + 2]
                        };
                    },
                    getSubphaseName: function(code) {
                        const subphase = this.subphases.find(sp => sp.code === code);
                        return subphase ? subphase.name : "";
                    },
                    getTeamTransition: function(relativeWeek) {
                        // Transitions happen every 3 weeks
                        return relativeWeek % 3 === 0 ? "rotate" : null;
                    }
                },
                misc: {
                    name: "Miscellaneous",
                    code: "MIS",
                    duration: 4,
                    class: "misc",
                    subphases: [
                        { code: "GY", name: "Gynecology", duration: 1 },
                        { code: "LM", name: "Lab Medicine", duration: 1 },
                        { code: "FM", name: "Forensic Medicine", duration: 1 },
                        { code: "YO", name: "Yoga", duration: 1 }
                    ],
                    getPosting: function(relativeWeek, subgroupIndex) {
                        // Mathematical approach for Miscellaneous rotation
                        // Each week, each subgroup is in a different posting
                        const rotationPatterns = [
                            ["GY", "LM", "FM", "YO"], // Subgroup 0
                            ["LM", "FM", "YO", "GY"], // Subgroup 1
                            ["FM", "YO", "GY", "LM"], // Subgroup 2
                            ["YO", "GY", "LM", "FM"]  // Subgroup 3
                        ];
                        
                        const pattern = rotationPatterns[subgroupIndex];
                        const code = pattern[relativeWeek - 1];
                        const name = this.getSubphaseName(code);
                        
                        return {
                            code: code,
                            name: name,
                            duration: 1,
                            weeks: [relativeWeek]
                        };
                    },
                    getSubphaseName: function(code) {
                        const subphase = this.subphases.find(sp => sp.code === code);
                        return subphase ? subphase.name : "";
                    },
                    getTeamTransition: function(relativeWeek) {
                        // Transitions happen every week
                        return "rotate";
                    }
                }
            },
            
            // Batch rotation sequences
            batchSequences: {
                A: ["medicine", "surgery", "obgy", "community", "misc"],
                B: ["surgery", "obgy", "community", "medicine", "misc"],
                C: ["obgy", "community", "medicine", "surgery", "misc"],
                D: ["community", "medicine", "surgery", "obgy", "misc"]
            },
            
            // Function to get the phase for a given week and batch
            getPhaseForWeek: function(week, batch) {
                const sequence = this.batchSequences[batch];
                
                if (week <= 12) return sequence[0];
                if (week <= 24) return sequence[1];
                if (week <= 36) return sequence[2];
                if (week <= 48) return sequence[3];
                return sequence[4];
            },
            
            // Function to get the relative week within a phase
            getRelativeWeek: function(week) {
                if (week <= 12) return week;
                if (week <= 24) return week - 12;
                if (week <= 36) return week - 24;
                if (week <= 48) return week - 36;
                return week - 48;
            },
            
            // Function to get the posting for a given week, subgroup, and batch
            getPostingForWeek: function(week, subgroup, batch) {
                const phase = this.getPhaseForWeek(week, batch);
                const relativeWeek = this.getRelativeWeek(week);
                const phaseInfo = this.phases[phase];
                
                // Get subgroup index (0-3)
                const subgroupIndex = parseInt(subgroup.charAt(1)) - 1;
                
                // Get posting from the phase's getPosting function
                const posting = phaseInfo.getPosting(relativeWeek, subgroupIndex);
                
                // Add phase information to the posting
                posting.phase = phase;
                
                // Add absolute weeks (converting from relative weeks)
                const weekOffset = week - relativeWeek;
                posting.absoluteWeeks = posting.weeks.map(w => w + weekOffset);
                
                // Add team transition information
                posting.teamTransition = phaseInfo.getTeamTransition(relativeWeek);
                
                return posting;
            },
            
            // Function to get the status of a subgroup at a given week
            getSubgroupStatus: function(week, subgroup, batch) {
                const posting = this.getPostingForWeek(week, subgroup, batch);
                const relativeWeek = this.getRelativeWeek(week);
                const phase = this.getPhaseForWeek(week, batch);
                
                // Check if this is the first or last week of a posting
                const isFirstWeek = posting.weeks[0] === relativeWeek;
                const isLastWeek = posting.weeks[posting.weeks.length - 1] === relativeWeek;
                
                if (isFirstWeek && isLastWeek) {
                    return "Complete";
                } else if (isFirstWeek) {
                    return "Starting";
                } else if (isLastWeek) {
                    return "Finishing";
                } else {
                    return "In Progress";
                }
            },
            
            // Function to get all phases
            getAllPhases: function() {
                return Object.keys(this.phases);
            },
            
            // Function to get all subgroups for a batch
            getSubgroups: function(batch) {
                return Array.from({length: this.subgroupsPerBatch}, (_, i) => `${batch}${i+1}`);
            },
            
            // Function to get the number of members in a subgroup based on posting
            getMemberCountForPosting: function(posting, phase) {
                return this.postingMemberCounts[phase][posting];
            }
        };
        
        // Function to update the current week schedule
        function updateCurrentWeekSchedule() {
            const week = parseInt($("#week-select").val());
            const batch = $("#batch-select").val();
            
            const subgroups = RotationSystem.getSubgroups(batch);
            
            let html = "";
            
            for (const subgroup of subgroups) {
                const posting = RotationSystem.getPostingForWeek(week, subgroup, batch);
                const phaseClass = posting.phase;
                const status = RotationSystem.getSubgroupStatus(week, subgroup, batch);
                const memberCount = RotationSystem.getMemberCountForPosting(posting.code, posting.phase);
                
                // Determine if this subgroup is in a transition
                let statusClass = "";
                if (posting.teamTransition) {
                    if (posting.teamTransition === "split") {
                        statusClass = "bg-yellow-100";
                    } else if (posting.teamTransition === "merge") {
                        statusClass = "bg-green-100";
                    } else if (posting.teamTransition === "rotate") {
                        statusClass = "bg-blue-100";
                    }
                }
                
                html += `
                    <tr class="${statusClass}">
                        <td class="border p-2">${subgroup}</td>
                        <td class="border p-2 ${phaseClass}">${posting.code}</td>
                        <td class="border p-2">${posting.name}</td>
                        <td class="border p-2">${posting.duration} week${posting.duration > 1 ? 's' : ''}</td>
                        <td class="border p-2">${memberCount}</td>
                        <td class="border p-2">${status}</td>
                    </tr>
                `;
            }
            
            $("#current-week-body").html(html);
            
            // Update current phase info
            const phase = RotationSystem.getPhaseForWeek(week, batch);
            const relativeWeek = RotationSystem.getRelativeWeek(week);
            const phaseName = RotationSystem.phases[phase].name;
            const phaseDuration = RotationSystem.phases[phase].duration;
            
            $("#current-phase-info").html(`Phase: <span class="font-bold">${phaseName} (Week ${relativeWeek} of ${phaseDuration})</span>`);
            $("#total-progress").html(`Overall Progress: <span class="font-bold">Week ${week} of 52</span>`);
            
            // Update progress bar
            const progressPercentage = (week / 52) * 100;
            $("#progress-bar").css("width", `${progressPercentage}%`);
        }
        
        // Function to initialize the schedule grid
        function initializeScheduleGrid() {
            const batch = $("#batch-select").val();
            
            // Initialize subgroups
            let subgroupsHtml = "";
            const subgroups = RotationSystem.getSubgroups(batch);
            
            for (const subgroup of subgroups) {
                subgroupsHtml += `<div class="week-cell batch-cell">${subgroup}</div>`;
            }
            $("#subgroups").html(subgroupsHtml);
            
            // Initialize schedule grid
            let gridHtml = "";
            
            for (let week = 1; week <= 52; week++) {
                let columnHtml = `<div class="flex flex-col">
                    <div class="week-cell header-cell">${week}</div>`;
                
                for (const subgroup of subgroups) {
                    const posting = RotationSystem.getPostingForWeek(week, subgroup, batch);
                    const phaseClass = posting.phase;
                    
                    // Add data attributes for transitions
                    let transitionClass = "";
                    if (posting.teamTransition) {
                        if (posting.teamTransition === "split") {
                            transitionClass = "team-split-animation";
                        } else if (posting.teamTransition === "merge") {
                            transitionClass = "team-merge-animation";
                        }
                    }
                    
                    columnHtml += `<div class="week-cell ${phaseClass} ${transitionClass}" 
                                       data-week="${week}" 
                                       data-subgroup="${subgroup}" 
                                       data-posting="${posting.code}" 
                                       data-phase="${posting.phase}" 
                                       data-name="${posting.name}"
                                       data-transition="${posting.teamTransition || ''}">${posting.code}</div>`;
                }
                
                columnHtml += `</div>`;
                gridHtml += columnHtml;
            }
            
            $("#schedule-grid").html(gridHtml);
            
            // Add phase markers
            addPhaseMarkers(batch);
            
            // Highlight the current week
            highlightCurrentWeek();
            
            // Add tooltip functionality
            $(".week-cell").hover(
                function(e) {
                    const posting = $(this).data("posting");
                    const phase = $(this).data("phase");
                    const name = $(this).data("name");
                    const subgroup = $(this).data("subgroup");
                    const week = $(this).data("week");
                    const transition = $(this).data("transition");
                    
                    if (posting && phase && name) {
                        let tooltipContent = `
                            <div class="font-bold">Week ${week}</div>
                            <div>Subgroup: ${subgroup}</div>
                            <div>Phase: ${RotationSystem.phases[phase].name}</div>
                            <div>Posting: ${posting} - ${name}</div>
                        `;
                        
                        if (transition) {
                            let transitionText = "";
                            if (transition === "split") {
                                transitionText = "Team Split (Transition Week)";
                            } else if (transition === "merge") {
                                transitionText = "Team Merge (Transition Week)";
                            } else if (transition === "rotate") {
                                transitionText = "Team Rotation (Transition Week)";
                            }
                            
                            tooltipContent += `<div class="mt-1 font-bold text-yellow-500">${transitionText}</div>`;
                        }
                        
                        $("#tooltip").html(tooltipContent);
                        
                        $("#tooltip").css({
                            top: e.pageY + 10,
                            left: e.pageX + 10,
                            display: "block"
                        });
                    }
                },
                function() {
                    $("#tooltip").css("display", "none");
                }
            );
            
            $(".week-cell").mousemove(function(e) {
                $("#tooltip").css({
                    top: e.pageY + 10,
                    left: e.pageX + 10
                });
            });
        }
        
        // Function to add phase markers to the schedule grid
        function addPhaseMarkers(batch) {
            const sequence = RotationSystem.batchSequences[batch];
            let markersHtml = "";
            
            // Add markers at phase boundaries
            const phaseWeeks = [1, 13, 25, 37, 49];
            
            for (let i = 0; i < phaseWeeks.length; i++) {
                const week = phaseWeeks[i];
                const phase = sequence[i];
                const phaseName = RotationSystem.phases[phase].name;
                const left = (week - 1) * 40 + 40; // 40px per week cell + offset for subgroup column
                
                markersHtml += `
                    <div class="phase-marker" style="left: ${left}px;">
                        <div class="phase-label">${phaseName}</div>
                    </div>
                `;
            }
            
            $("#phase-markers").html(markersHtml);
        }
        
        // Function to highlight the current week
        function highlightCurrentWeek() {
            const week = parseInt($("#week-select").val());
            
            // Remove highlight from all cells
            $(".week-cell").removeClass("highlight");
            
            // Add highlight to current week cells
            $(`.week-cell[data-week="${week}"]`).addClass("highlight");
        }
        
        // Function to filter the schedule grid by phase
        function filterScheduleByPhase(phase) {
            if (phase === "all") {
                $(".week-cell").show();
                $(".phase-marker").show();
                return;
            }
            
            $(".phase-marker").hide();
            
            $(".week-cell").each(function() {
                const cellPhase = $(this).data("phase");
                if (cellPhase === phase || !cellPhase) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        }
        
        // Function to animate team transitions
        function animateTeamTransitions() {
            // Reset any existing animations
            $(".team-split-animation").removeClass("active");
            $(".team-merge-animation").removeClass("active");
            $(".split-animation").removeClass("split-animation");
            $(".merge-animation").removeClass("merge-animation");
            
            // Get all cells with transitions
            const transitionCells = $(".week-cell[data-transition]").filter(function() {
                return $(this).data("transition") !== "";
            });
            
            // Animate each transition cell sequentially
            let delay = 0;
            transitionCells.each(function() {
                const cell = $(this);
                const transition = cell.data("transition");
                
                setTimeout(function() {
                    if (transition === "split") {
                        cell.addClass("active split-animation");
                    } else if (transition === "merge") {
                        cell.addClass("active merge-animation");
                    } else if (transition === "rotate") {
                        cell.addClass("active split-animation");
                        setTimeout(() => cell.addClass("merge-animation"), 500);
                    }
                    
                    // Remove the animation class after it completes
                    setTimeout(function() {
                        cell.removeClass("active split-animation merge-animation");
                    }, 1500);
                }, delay);
                
                delay += 200;
            });
        }
        
        // Initialize the page
        $(document).ready(function() {
            // Initialize the schedule grid
            initializeScheduleGrid();
            
            // Initialize the current week schedule
            updateCurrentWeekSchedule();
            
            // Handle batch selection change
            $("#batch-select").change(function() {
                initializeScheduleGrid();
                updateCurrentWeekSchedule();
            });
            
            // Handle week selection change
            $("#week-select").change(function() {
                const week = parseInt($(this).val());
                
                // Validate week range
                if (week < 1) {
                    $(this).val(1);
                } else if (week > 52) {
                    $(this).val(52);
                }
                
                highlightCurrentWeek();
                updateCurrentWeekSchedule();
            });
            
            // Handle phase selection change
            $("#phase-select").change(function() {
                const week = parseInt($(this).val());
                $("#week-select").val(week).change();
            });
            
            // Handle previous week button
            $("#prev-week").click(function() {
                const week = parseInt($("#week-select").val());
                if (week > 1) {
                    $("#week-select").val(week - 1).change();
                }
            });
            
            // Handle next week button
            $("#next-week").click(function() {
                const week = parseInt($("#week-select").val());
                if (week < 52) {
                    $("#week-select").val(week + 1).change();
                }
            });
            
            // Handle reset button
            $("#reset-btn").click(function() {
                $("#week-select").val(1).change();
                $("#batch-select").val("A").change();
                stopSimulation();
                filterScheduleByPhase("all");
                $("#view-all").addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-medicine, #view-surgery, #view-obgy, #view-community, #view-misc").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            // Handle animate transitions button
            $("#animate-transitions-btn").click(function() {
                animateTeamTransitions();
            });
            
            // Handle phase filter buttons
            $("#view-all").click(function() {
                filterScheduleByPhase("all");
                $(this).addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-medicine, #view-surgery, #view-obgy, #view-community, #view-misc").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            $("#view-medicine").click(function() {
                filterScheduleByPhase("medicine");
                $(this).addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-all, #view-surgery, #view-obgy, #view-community, #view-misc").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            $("#view-surgery").click(function() {
                filterScheduleByPhase("surgery");
                $(this).addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-all, #view-medicine, #view-obgy, #view-community, #view-misc").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            $("#view-obgy").click(function() {
                filterScheduleByPhase("obgy");
                $(this).addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-all, #view-medicine, #view-surgery, #view-community, #view-misc").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            $("#view-community").click(function() {
                filterScheduleByPhase("community");
                $(this).addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-all, #view-medicine, #view-surgery, #view-obgy, #view-misc").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            $("#view-misc").click(function() {
                filterScheduleByPhase("misc");
                $(this).addClass("bg-blue-600 text-white").removeClass("bg-gray-200 text-gray-800");
                $("#view-all, #view-medicine, #view-surgery, #view-obgy, #view-community").removeClass("bg-blue-600 text-white").addClass("bg-gray-200 text-gray-800");
            });
            
            // Simulation variables
            let simulationInterval = null;
            
            // Handle simulation button
            $("#simulate-btn").click(function() {
                if (!simulationInterval) {
                    startSimulation();
                }
            });
            
            // Handle stop simulation button
            $("#stop-simulation").click(function() {
                stopSimulation();
            });
            
            // Function to start simulation
            function startSimulation() {
                $("#simulate-btn").hide();
                $("#stop-simulation").show();
                
                simulationInterval = setInterval(function() {
                    const week = parseInt($("#week-select").val());
                    if (week < 52) {
                        $("#week-select").val(week + 1).change();
                    } else {
                        stopSimulation();
                    }
                }, 1000);
            }
            
            // Function to stop simulation
            function stopSimulation() {
                if (simulationInterval) {
                    clearInterval(simulationInterval);
                    simulationInterval = null;
                }
                
                $("#simulate-btn").show();
                $("#stop-simulation").hide();
            }
        });
    </script>
</body>
</html>